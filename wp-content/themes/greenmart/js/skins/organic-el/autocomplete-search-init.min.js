"use strict";class AutoComplete{constructor(){"undefined"!=typeof greenmart_settings&&this._callAjaxSearch()}_callAjaxSearch(){var t=this,n=greenmart_settings.ajaxurl+"?action=greenmart_autocomplete_search&security="+greenmart_settings.search_nonce,r=jQuery("form.greenmart-ajax-search"),a=function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")};r.each(function(){var e=jQuery(this),o=e.find("input[name=s]"),i=Boolean(e.data("thumbnail")),s=Boolean(e.data("price"));o.devbridgeAutocomplete({serviceUrl:t._AutoServiceUrl(o,n),minChars:t._AutoMinChars(o),appendTo:t._AutoAppendTo(o),width:"100%",maxHeight:"initial",onSelect:function(e){e.link.length>0&&(window.location.href=e.link)},onSearchStart:function(e){o.parents("form").addClass("tbay-loading")},beforeRender:function(e,t){void 0!==t[0].result&&jQuery(e).prepend('<div class="list-header"><span>'+t[0].result+"</span></div>"),t[0].view_all&&jQuery(e).append('<div class="view-all-products"><span>'+greenmart_settings.view_all+"</span></div>")},onSearchComplete:function(e,t){r.removeClass("tbay-loading"),jQuery(this).parents("form").addClass("open"),jQuery(document.body).trigger("tbay_searchcomplete")},formatResult:(e,n)=>{let r=t._initformatResult(e,n,a,i,s);return r},onHide:function(e){jQuery(this).parents("form").hasClass("open")&&jQuery(this).parents("form").removeClass("open")}}),jQuery("body").click(function(){o.is(":focus")||o.each(function(){let e=jQuery(this).devbridgeAutocomplete();void 0!==e&&e.hide()})})});var o=r.find('[name="product_cat"], [name="category"]');o.length&&o.change(function(e){let r=jQuery(e.target).parents("form").find("input[name=s]"),a=r.devbridgeAutocomplete();a.hide(),a.setOptions({serviceUrl:t._AutoServiceUrl(r,n)}),a.onValueChange()}),jQuery(document.body).on("tbay_searchcomplete",function(){jQuery(".view-all-products").on("click",function(){jQuery(this).parents("form").submit(),e.stopPropagation()})})}_AutoServiceUrl(e,t){let n=e.parents("form"),r=parseInt(n.data("count")),a=n.data("post-type"),o=(n.data("search-in"),n.find('[name="product_cat"], [name="category"]').val());return r>0&&(t+="&number="+r),t+="&post_type="+a,o&&(t+="&product_cat="+o),t}_AutoAppendTo(e){let t=e.parents("form");return void 0!==t.data("appendto")?t.data("appendto"):t.find(".greenmart-search-results")}_AutoMinChars(e){let t=e.parents("form");return parseInt(t.data("minchars"))}_initformatResult(e,t,n,r,a){"&"==t&&(t="&#038;");var o="("+n(t)+")",i="";return r&&e.image&&(i+=' <div class="suggestion-thumb">'+e.image+"</div>"),i+='<div class="suggestion-group">',i+='<div class="suggestion-title product-title">'+e.value.replace(new RegExp(o,"gi"),"<strong>$1</strong>").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/&lt;(\/?strong)&gt;/g,"<$1>")+"</div>",e.no_found&&(i='<div class="suggestion-title no-found-msg">'+e.value+"</div>"),a&&e.price&&(i+=' <div class="suggestion-price price">'+e.price+"</div>"),i+="</div>"}}jQuery(document).ready(()=>{new AutoComplete});var AutoCompleteHandler=function(e,t){new AutoComplete};jQuery(window).on("elementor/frontend/init",function(){elementorFrontend.hooks.addAction("frontend/element_ready/tbay-search-form.default",AutoCompleteHandler)});
